<script>
    // ... (variáveis e funções omitidas) ...

    function render(){
      // ... (lógica de ordenação e filtro omitida) ...

      rows.innerHTML = '';
      for (const s of filteredSales){
        const t = calcSaleTotals(s);
        const payStr = (s.payments||[]).map(p=>{
          const parc = p.installments ? ` ${p.installments}` : '';
          const det  = p.detail ? ` ${p.detail}` : '';
          return `${p.method}${parc}${det}: ${fmt.format(+p.amount||0)}`;
        }).join(' • ');
        
        // Lógica do Alerta: Custo zero NÃO CONFIRMADO
        const costAlert = t.isCostUnconfirmed ? ' ⚠️' : ''; 
        
        const tr = document.createElement('tr');
        tr.className = 'border-t border-white/10 hover:bg-white/5';
        tr.innerHTML = `
          <td class="p-3">${formatDate(s.date || '')}</td>
          <td class="p-3">${s.os||''}</td>
          <td class="p-3">${(s.products||[]).map(p=>p.name).join(', ')}</td>
          <td class="p-3 text-right">${fmt.format(t.totCusto)}${costAlert}</td>
          <td class="p-3 text-right">${fmt.format(t.totVenda)}</td>
          <td class="p-3 text-right">${fmt.format(t.totTaxa)}</td>
          <td class="p-3 text-right">${fmt.format(t.lucro)}</td>
          <td class="p-3">${payStr}</td>
          <td class="p-3">
            <button class="px-1.5 py-0.5 rounded-lg bg-slate-700 hover:bg-slate-600 edit" data-id="${s.id}">Editar</button>
            <button class="px-1 py-0.5 rounded-lg bg-red-600/80 hover:bg-red-600 delete" data-id="${s.id}">Excluir</button>
          </td>`;
        rows.appendChild(tr);
      }
      // ... (lógica de KPIs omitida) ...
    }

    // ... (restante do script omitido) ...
  </script>
</body>
</html>
